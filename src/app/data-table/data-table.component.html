<app-header></app-header>

<div class="container">
  <app-spinner></app-spinner>
  <!-- <ngx-datatable
    class="material"
    [rows]="rows"
    [loadingIndicator]="loadingIndicator"
    [columns]="columns"
    [columnMode]="ColumnMode.force"
    [headerHeight]="50"
    [footerHeight]="50"
    rowHeight="auto"
    [reorderable]="reorderable"
  >
  </ngx-datatable> -->

  <!-- <div class="card-body">
     
    <table
      id="example"
      class="table table-bordered table-striped table-hover"
      datatable
      [dtOptions]="dtOptions"
      [dtTrigger]="dtTrigger"
    >
      <thead>
        <tr>
          <th>Id</th>
          <th>Question</th>
          <th>Type</th>
          <th>Action</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let question of tableData">
          <td>{{ question.id }}</td>
          <td>{{ question.question }}</td>
          <td>{{ question.type }}</td>
          <td><button class="edit_btn dt-control">edit</button></td>
        </tr>
      </tbody>
    </table>
  </div> -->
  <!-- <ngx-datatable
    #myTable
    class="material expandable"
    [columnMode]="ColumnMode.force"
    [headerHeight]="50"
    [footerHeight]="50"
    [rowHeight]="50"
    [scrollbarV]="true"
    [scrollbarH]="true"
    [rows]="rows"
    rowHeight="auto"
    (page)="onPage($event)"
  >
    <ngx-datatable-row-detail
      [rowHeight]="100"
      #myDetailRow
      (toggle)="onDetailToggle($event)"
    >
      <ng-template
        let-row="row"
        let-expanded="expanded"
        ngx-datatable-row-detail-template
      >
        <div style="padding-left: 35px">
          <div><strong>Options</strong></div>
          <div>{{ row.options.id }}, {{ row.options.option }}</div>
        </div>
      </ng-template>
    </ngx-datatable-row-detail>
    <ngx-datatable-column
      [width]="50"
      [resizeable]="false"
      [sortable]="false"
      [draggable]="false"
      [canAutoResize]="false"
    >
      <ng-template
        let-row="row"
        let-expanded="expanded"
        ngx-datatable-cell-template
      >
        <a
          href="javascript:void(0)"
          [class.datatable-icon-right]="!expanded"
          [class.datatable-icon-down]="expanded"
          title="Expand/Collapse Row"
          (click)="toggleExpandRow(row)"
          >open
        </a>
      </ng-template>
    </ngx-datatable-column> -->
  <!-- <ngx-datatable-column name="Index" [width]="80">
      <ng-template
        let-rowIndex="rowIndex"
        let-row="row"
        ngx-datatable-cell-template
      >
        <strong>{{ rowIndex }}</strong>
      </ng-template>
    </ngx-datatable-column> -->
  <!-- <ngx-datatable-column name="Expanded" [width]="80">
      <ng-template
        let-row="row"
        let-expanded="expanded"
        ngx-datatable-cell-template
      >
        <strong>{{ expanded === 1 }}</strong>
      </ng-template>
    </ngx-datatable-column> -->
  <!-- <ngx-datatable-column name="Id" [width]="200">
      <ng-template let-value="value" ngx-datatable-cell-template>
        <strong>{{ value }}</strong>
      </ng-template>
    </ngx-datatable-column>
    <ngx-datatable-column name="Question" [width]="300">
     
    </ngx-datatable-column>
    <ngx-datatable-column name="Type"></ngx-datatable-column>
  </ngx-datatable> -->
  <mat-form-field appearance="standard" class="full-width">
    <mat-label>Search</mat-label>
    <input matInput (keyup)="applyFilter($event)" placeholder="Search" #input />
  </mat-form-field>
  <table mat-table [dataSource]="dataStudentsList" multiTemplateDataRows>
    <ng-container matColumnDef="id">
      <th mat-header-cell *matHeaderCellDef>ID</th>
      <td mat-cell *matCellDef="let element">{{ element.id }}</td>
    </ng-container>

    <ng-container matColumnDef="question">
      <th mat-header-cell *matHeaderCellDef>Question</th>
      <td mat-cell *matCellDef="let element">{{ element.question }}</td>
    </ng-container>

    <ng-container matColumnDef="type">
      <th mat-header-cell *matHeaderCellDef>Type</th>
      <td mat-cell *matCellDef="let element">{{ element.type }}</td>
    </ng-container>

    <ng-container matColumnDef="actions">
      <th mat-header-cell *matHeaderCellDef>Actions</th>
      <td mat-cell *matCellDef="let element">
        <a
          mat-button
          href="javascript:void()"
          (click)="element.isExpanded = !element.isExpanded"
        >
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="24"
            height="24"
            viewBox="0 0 24 24"
          >
            <path
              d="M14 12c0 1.103-.897 2-2 2s-2-.897-2-2 .897-2 2-2 2 .897 2 2zm10-.449s-4.252 7.449-11.985 7.449c-7.18 0-12.015-7.449-12.015-7.449s4.446-6.551 12.015-6.551c7.694 0 11.985 6.551 11.985 6.551zm-8 .449c0-2.208-1.791-4-4-4-2.208 0-4 1.792-4 4 0 2.209 1.792 4 4 4 2.209 0 4-1.791 4-4z"
            />
          </svg>
        </a>
        <a
          mat-button
          href="javascript:void()"
          (click)="seedFormData(element.id)"
          data-bs-toggle="modal"
          data-bs-target="#staticBackdrop"
          ><svg
            clip-rule="evenodd"
            color="#f6f7f7"
            fill-rule="evenodd"
            stroke-linejoin="round"
            stroke-miterlimit="2"
            viewBox="0 0 24 24"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              d="m19 20.25c0-.402-.356-.75-.75-.75-2.561 0-11.939 0-14.5 0-.394 0-.75.348-.75.75s.356.75.75.75h14.5c.394 0 .75-.348.75-.75zm-12.023-7.083c-1.334 3.916-1.48 4.232-1.48 4.587 0 .527.46.749.749.749.352 0 .668-.137 4.574-1.493zm1.06-1.061 3.846 3.846 8.824-8.814c.195-.195.293-.451.293-.707 0-.255-.098-.511-.293-.706-.692-.691-1.742-1.741-2.435-2.432-.195-.195-.451-.293-.707-.293-.254 0-.51.098-.706.293z"
              fill-rule="nonzero"
            />
          </svg>
        </a>
        <a
          mat-button
          href="javascript:void()"
          (click)="deleteQuestions(element)"
          ><svg
            clip-rule="evenodd"
            fill-rule="evenodd"
            stroke-linejoin="round"
            stroke-miterlimit="2"
            viewBox="0 0 24 24"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              d="m20.015 6.506h-16v14.423c0 .591.448 1.071 1 1.071h14c.552 0 1-.48 1-1.071 0-3.905 0-14.423 0-14.423zm-5.75 2.494c.414 0 .75.336.75.75v8.5c0 .414-.336.75-.75.75s-.75-.336-.75-.75v-8.5c0-.414.336-.75.75-.75zm-4.5 0c.414 0 .75.336.75.75v8.5c0 .414-.336.75-.75.75s-.75-.336-.75-.75v-8.5c0-.414.336-.75.75-.75zm-.75-5v-1c0-.535.474-1 1-1h4c.526 0 1 .465 1 1v1h5.254c.412 0 .746.335.746.747s-.334.747-.746.747h-16.507c-.413 0-.747-.335-.747-.747s.334-.747.747-.747zm4.5 0v-.5h-3v.5z"
              fill-rule="nonzero"
            />
          </svg>
        </a>
      </td>
    </ng-container>
    <!-- <ng-container matColumnDef="delete">
      <th mat-header-cell *matHeaderCellDef>Delete</th>
      <td mat-cell *matCellDef="let element">
        <button (click)="deleteQuestions(element)">delete</button>

      </td>
    </ng-container> -->

    <!-- Template for details row -->
    <ng-container matColumnDef="expandedDetail">
      <td
        mat-cell
        *matCellDef="let element"
        [attr.colspan]="displayedStudentsColumnsList.length"
      >
        <div
          class="row student-element-detail"
          [@detailExpand]="element.isExpanded ? 'expanded' : 'collapsed'"
        >
          <mat-list>
            <div mat-subheader>Subjects of {{ element.id }}</div>
            <mat-list-item *ngFor="let subject of element.options">
              <div mat-line>{{ subject.id }}</div>
              <div mat-line>
                {{ subject.option }}
              </div>
            </mat-list-item>
          </mat-list>
        </div>
      </td>
    </ng-container>

    <tr
      mat-header-row
      *matHeaderRowDef="displayedStudentsColumnsList; sticky: true"
    ></tr>
    <tr
      mat-row
      *matRowDef="let element; columns: displayedStudentsColumnsList"
      class="student-element-row"
      [class.student-expanded-row]="element.isExpanded"
    ></tr>

    <!-- Extra row to show detail content column -->
    <tr
      mat-row
      *matRowDef="let row; columns: ['expandedDetail']"
      class="student-detail-row"
    ></tr>
  </table>
  <mat-paginator
    #paginatorPageSize
    [pageSizeOptions]="pageSizes"
    showFirstLastButtons
  ></mat-paginator>

  <div class="btn_container">
    <!-- <button
      type="button"
      class="add_btn"
      (click)="toggleShowDiv('expandForm'); gotoSection()"
    >
      Add Question
    </button>
    <div [@slideInOut]="animationState" class="expandForm" #sectionNeedToScroll>
      <app-add-questions></app-add-questions>
    </div> -->
    <div class="tabs" id="one_scroll">
      <div class="tab">
        <input
          type="checkbox"
          id="chck1"
          (click)="gotoSection('#one_scroll')"
        />
        <label class="tab-label" for="chck1">Add Question + </label>

        <div class="tab-content">
          <app-add-questions></app-add-questions>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal -->
  <div
    class="modal fade"
    id="staticBackdrop"
    data-bs-backdrop="static"
    data-bs-keyboard="false"
    tabindex="-1"
    aria-labelledby="staticBackdropLabel"
    aria-hidden="true"
  >
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h3 class="modal-title" id="staticBackdropLabel">Update Question</h3>
          <button
            type="button"
            class="btn-close"
            data-bs-dismiss="modal"
            aria-label="Close"
            (click)="close()"
          ></button>
        </div>
        <div class="modal-body">
          <form [formGroup]="updateForm" (ngSubmit)="onSubmit()">
            <div class="flex_form">
              <div class="form_question">
                <label>Question Name</label>
                <input type="text" formControlName="question" />
              </div>
              <div class="form_question">
                <label> ID</label> <input type="text" formControlName="id" />
              </div>
              <div class="form_question radio_question">
                <p>Type</p>
                <label>
                  <input
                    type="radio"
                    value="single-choice"
                    formControlName="type"
                    class="radio_input"
                  />
                  <span>Single Choice</span>
                </label>
                <label>
                  <input
                    type="radio"
                    value="multiple-choice"
                    formControlName="type"
                    class="radio_input"
                  />
                  <span>Multi Choice</span>
                </label>
              </div>
            </div>

            <div formArrayName="options">
              <div
                *ngFor="
                  let optionForm of updateForm.get('options')?.controls;
                  let optionIndex = index
                "
                [formGroupName]="optionIndex"
              >
                <div class="accordion-wrapper">
                  <div class="accordion">
                    <input type="radio" name="radio-a" id="{{ optionIndex }}" />
                    <label class="accordion-label" for="{{ optionIndex }}"
                      >Option {{ optionIndex + 1 }}</label
                    >
                    <div class="accordion-content">
                      <div class="flex_form">
                        <div class="form_question">
                          <label> ID</label>
                          <input formControlName="id" type="text" />
                        </div>
                        <div class="form_question">
                          <label> Option</label>
                          <input formControlName="option" type="text" />
                        </div>
                      </div>
                      <div formArrayName="recommendation">
                        <div
                          *ngFor="
                            let recommendationForm of optionForm.get(
                              'recommendation'
                            ).controls;
                            let recommIndex = index
                          "
                          [formGroupName]="recommIndex"
                        >
                          <div class="flex_form">
                            <div class="reco_form">
                              <label> CMS </label
                              ><select formControlName="CMS" id="CMS">
                                <option value="AEM">AEM</option>
                                <option value="Drupal">Drupal</option>
                                <option value="Wordpress">Wordpress</option>
                                <option value="Kentico">Kentico</option>
                                <option value="Sitecore">Sitecore</option>
                                <option value="Hubspot">Hubspot</option>
                                <option value="Magento">Magento</option>
                                <option value="Shopify">Shopify</option>
                                <option value="BigCommerce">BigCommerce</option>
                                <option value="Prestashop">Prestashop</option>
                                <option value="Django CMS">Django CMS</option>
                                <option value="Sharepoint">Sharepoint</option>
                                <option value="Joomla">Joomla</option>
                                <option value="Craft CMS">Craft CMS</option>
                              </select>
                            </div>
                            <div class="reco_form">
                              <label> Value</label>
                              <input
                                formControlName="recommendation_value"
                                type="text"
                              />
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class="update_footer">
              <button
                type="button"
                data-bs-dismiss="modal"
                (click)="close()"
                class="cls_btn"
              >
                Cancel
              </button>
              <button type="submit" class="sub_btn">Update</button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
  <!--Modal Close-->
</div>
